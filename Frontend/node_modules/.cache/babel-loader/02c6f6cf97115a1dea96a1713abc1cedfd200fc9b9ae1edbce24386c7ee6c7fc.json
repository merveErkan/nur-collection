{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import PanelTemplate from\"./PanelTemplate\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Orders(){const[orders,setOrders]=useState([]);const[pendingOrders,setPendingOrders]=useState([]);const[approvedOrders,setApprovedOrders]=useState([]);const fetchData=async()=>{try{const resP=await fetch(\"https://nur-collection-backend-860749273875.europe-west1.run.app/order/pending\");const dataP=await resP.json();if(dataP.success)setPendingOrders(dataP.orders);const resA=await fetch(\"https://nur-collection-backend-860749273875.europe-west1.run.app/order/approved-list\");const dataA=await resA.json();if(dataA.success)setApprovedOrders(dataA.orders);}catch(error){console.error(\"Veri çekme hatası:\",error);}};useEffect(()=>{fetchData();},[]);useEffect(()=>{fetch(\"https://nur-collection-backend-860749273875.europe-west1.run.app/order/pending\").then(res=>res.json()).then(data=>{if(data.success){setOrders(data.orders);}});},[]);const handleApprove=async id=>{const res=await fetch(\"https://nur-collection-backend-860749273875.europe-west1.run.app/order/approve/\".concat(id),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({approved_by_id:localStorage.getItem(\"person_id\"),approved_by_role:localStorage.getItem(\"role\")})});const data=await res.json();if(data.success){alert(\"Sipariş Onaylandı ve Arşive Taşındı!\");fetchData();// Listeleri yenilemek için verileri tekrar çek\n}};const handleReject=async id=>{if(!window.confirm(\"Bu siparişi reddetmek ve tamamen silmek istediğine emin misin?\"))return;const res=await fetch(\"https://nur-collection-backend-860749273875.europe-west1.run.app/order/reject/\".concat(id),{method:\"DELETE\"});const data=await res.json();if(data.success){alert(\"Sipariş tamamen silindi.\");setPendingOrders(prev=>prev.filter(o=>o.pending_order_id!==id));}};return/*#__PURE__*/_jsx(PanelTemplate,{title:\"Orders\",rightContent:/*#__PURE__*/_jsxs(\"div\",{style:{width:\"100%\"},children:[/*#__PURE__*/_jsx(\"h3\",{style:{color:\"#d35400\",textAlign:\"center\"},children:\" Approved Orders\"}),approvedOrders.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No approved orders yet.\"}):/*#__PURE__*/_jsxs(\"table\",{className:\"orders-table\",border:\"1\",style:{fontSize:\"10px\",marginTop:\"10px\"},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Order ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Customer\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Order Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Total Amount\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Approved By\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:approvedOrders.map(o=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:o.order_id}),/*#__PURE__*/_jsx(\"td\",{children:o.customer_name}),/*#__PURE__*/_jsx(\"td\",{children:o.order_date}),/*#__PURE__*/_jsxs(\"td\",{children:[o.total_amount,\" \\u20BA\"]}),/*#__PURE__*/_jsxs(\"td\",{children:[\" \",o.approved_by_name,\" (\",o.approved_by_role,\")\"]})]},o.order_id))})]}),/*#__PURE__*/_jsx(\"div\",{style:{margin:\"50px 0\"}}),/*#__PURE__*/_jsx(\"h3\",{style:{color:\"#d35400\",textAlign:\"center\"},children:\" Pending Orders\"}),pendingOrders.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No pending orders.\"}):/*#__PURE__*/_jsxs(\"table\",{className:\"orders-table\",border:\"1\",style:{fontSize:\"10px\",marginTop:\"10px\"},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Pending ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Customer\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Order Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Total Amount\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:pendingOrders.map(order=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:order.pending_order_id}),/*#__PURE__*/_jsx(\"td\",{children:order.customer_name}),/*#__PURE__*/_jsx(\"td\",{children:order.order_date}),/*#__PURE__*/_jsxs(\"td\",{children:[order.total_amount,\" \\u20BA\"]}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"action-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"confirm-btn\",onClick:()=>handleApprove(order.pending_order_id),children:\"Confirm\"}),/*#__PURE__*/_jsx(\"button\",{className:\"reject-btn\",onClick:()=>handleReject(order.pending_order_id),children:\"Delete\"})]})})]},order.pending_order_id))})]}),/*#__PURE__*/_jsx(\"div\",{style:{margin:\"50px 0\"}})]})});}export default Orders;","map":{"version":3,"names":["React","useEffect","useState","PanelTemplate","jsx","_jsx","jsxs","_jsxs","Orders","orders","setOrders","pendingOrders","setPendingOrders","approvedOrders","setApprovedOrders","fetchData","resP","fetch","dataP","json","success","resA","dataA","error","console","then","res","data","handleApprove","id","concat","method","headers","body","JSON","stringify","approved_by_id","localStorage","getItem","approved_by_role","alert","handleReject","window","confirm","prev","filter","o","pending_order_id","title","rightContent","style","width","children","color","textAlign","length","className","border","fontSize","marginTop","map","order_id","customer_name","order_date","total_amount","approved_by_name","margin","order","onClick"],"sources":["/Users/merveerkan/Desktop/NurCollection/Frontend/src/pages/Orders.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport PanelTemplate from \"./PanelTemplate\";\n\nfunction Orders() {\n    const [orders, setOrders] = useState([]);\n    const [pendingOrders, setPendingOrders] = useState([]);\n    const [approvedOrders, setApprovedOrders] = useState([]);\n\n    const fetchData = async () => {\n        try {\n\n            const resP = await fetch(\"https://nur-collection-backend-860749273875.europe-west1.run.app/order/pending\");\n            const dataP = await resP.json();\n            if (dataP.success) setPendingOrders(dataP.orders);\n\n\n            const resA = await fetch(\"https://nur-collection-backend-860749273875.europe-west1.run.app/order/approved-list\");\n            const dataA = await resA.json();\n            if (dataA.success) setApprovedOrders(dataA.orders);\n        } catch (error) {\n            console.error(\"Veri çekme hatası:\", error);\n        }\n    };\n    useEffect(() => { fetchData(); }, []);\n\n    useEffect(() => {\n        fetch(\"https://nur-collection-backend-860749273875.europe-west1.run.app/order/pending\")\n            .then(res => res.json())\n            .then(data => {\n                if (data.success) {\n                    setOrders(data.orders);\n                }\n            });\n    }, []);\n\n    const handleApprove = async (id) => {\n        const res = await fetch(`https://nur-collection-backend-860749273875.europe-west1.run.app/order/approve/${id}`, {\n            method: \"POST\",\n            headers: { \"Content-Type\": \"application/json\" },\n            body: JSON.stringify({\n                approved_by_id: localStorage.getItem(\"person_id\"),\n                approved_by_role: localStorage.getItem(\"role\")\n            })\n        });\n        const data = await res.json();\n        if (data.success) {\n            alert(\"Sipariş Onaylandı ve Arşive Taşındı!\");\n            fetchData(); // Listeleri yenilemek için verileri tekrar çek\n        }\n    };\n\n    const handleReject = async (id) => {\n        if (!window.confirm(\"Bu siparişi reddetmek ve tamamen silmek istediğine emin misin?\")) return;\n\n        const res = await fetch(`https://nur-collection-backend-860749273875.europe-west1.run.app/order/reject/${id}`, {\n            method: \"DELETE\"\n        });\n        const data = await res.json();\n        if (data.success) {\n            alert(\"Sipariş tamamen silindi.\");\n            setPendingOrders(prev => prev.filter(o => o.pending_order_id !== id));\n        }\n    };\n\n    return (\n        <PanelTemplate\n            title=\"Orders\"\n            rightContent={\n                <div style={{ width: \"100%\" }}>\n\n\n                    <h3 style={{ color: \"#d35400\", textAlign: \"center\" }}> Approved Orders</h3>\n                    {approvedOrders.length === 0 ? (\n                        <p>No approved orders yet.</p>\n                    ) : (\n                        <table className=\"orders-table\" border=\"1\" style={{\n                            fontSize: \"10px\",\n                            marginTop: \"10px\"\n                        }}>\n                            <thead>\n                                <tr>\n                                    <th>Order ID</th>\n                                    <th>Customer</th>\n                                    <th>Order Date</th>\n                                    <th>Total Amount</th>\n                                    <th>Approved By</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {approvedOrders.map(o => (\n                                    <tr key={o.order_id}>\n                                        <td>{o.order_id}</td>\n                                        <td>{o.customer_name}</td>\n                                        <td>{o.order_date}</td>\n                                        <td>{o.total_amount} ₺</td>\n                                        <td> {o.approved_by_name} ({o.approved_by_role})</td>\n                                    </tr>\n                                ))}\n                            </tbody>\n                        </table>\n                    )}\n\n\n                    <div style={{ margin: \"50px 0\" }}></div>\n\n                    <h3 style={{ color: \"#d35400\", textAlign: \"center\" }}> Pending Orders</h3>\n                    {pendingOrders.length === 0 ? (\n                        <p>No pending orders.</p>\n                    ) : (\n                        <table className=\"orders-table\" border=\"1\" style={{\n                            fontSize: \"10px\",\n                            marginTop: \"10px\"\n                        }}>\n                            <thead>\n                                <tr>\n                                    <th>Pending ID</th>\n                                    <th>Customer</th>\n                                    <th>Order Date</th>\n                                    <th>Total Amount</th>\n                                    <th>Action</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {pendingOrders.map(order => (\n                                    <tr key={order.pending_order_id}>\n                                        <td>{order.pending_order_id}</td>\n                                        <td>{order.customer_name}</td>\n                                        <td>{order.order_date}</td>\n                                        <td>{order.total_amount} ₺</td>\n                                        <td>\n                                            <div className=\"action-buttons\">\n                                                <button\n                                                    className=\"confirm-btn\"\n                                                    onClick={() => handleApprove(order.pending_order_id)}\n                                                >\n                                                    Confirm\n                                                </button>\n                                                <button\n                                                    className=\"reject-btn\"\n                                                    onClick={() => handleReject(order.pending_order_id)}\n                                                >\n                                                    Delete\n                                                </button>\n                                            </div>\n                                        </td>\n                                    </tr>\n                                ))}\n                            </tbody>\n                        </table>\n                    )}\n                    <div style={{ margin: \"50px 0\" }}></div>\n                </div>\n            }\n        />\n    );\n}\n\nexport default Orders;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}