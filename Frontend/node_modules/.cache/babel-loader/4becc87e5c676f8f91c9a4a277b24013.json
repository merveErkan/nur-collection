{"ast":null,"code":"var _jsxFileName = \"/Users/merveerkan/Desktop/NurCollection/Frontend/src/pages/Orders.js\";\nimport React, { useEffect, useState } from \"react\";\nimport PanelTemplate from \"./PanelTemplate\";\nfunction Orders() {\n  const [orders, setOrders] = useState([]);\n  useEffect(() => {\n    fetch(\"http://localhost:5003/order/pending\").then(res => res.json()).then(data => {\n      if (data.success) {\n        setOrders(data.orders);\n      }\n    });\n  }, []);\n  const approveOrder = async pendingOrderId => {\n    // 1. ADIM: Bilgileri tek baÅŸÄ±na deÄŸil, \"info\" paketi iÃ§inden alÄ±yoruz\n    const storedInfo = localStorage.getItem(\"info\");\n    const info = storedInfo ? JSON.parse(storedInfo) : null;\n\n    // ðŸ”¥ KRÄ°TÄ°K DÃœZELTME: info paketinin iÃ§indeki person_id ve role alanlarÄ±nÄ± kullanÄ±yoruz\n    const approvedById = info === null || info === void 0 ? void 0 : info.person_id;\n    const approvedByRole = (info === null || info === void 0 ? void 0 : info.role) || (window.location.pathname.includes(\"manager\") ? \"manager\" : \"employee\");\n    if (!approvedById) {\n      alert(\"Onaylayan kiÅŸi (oturum bilgisi) bulunamadÄ±. LÃ¼tfen tekrar giriÅŸ yapÄ±n.\");\n      return;\n    }\n    try {\n      const res = await fetch(\"http://localhost:5003/order/approve/\".concat(pendingOrderId), {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          approved_by_id: approvedById,\n          approved_by_role: approvedByRole\n        })\n      });\n      const data = await res.json();\n      if (data.success) {\n        alert(\"SipariÅŸ baÅŸarÄ±yla onaylandÄ±\");\n        setOrders(prev => prev.filter(o => o.pending_order_id !== pendingOrderId));\n      } else {\n        alert(data.message);\n      }\n    } catch (err) {\n      console.error(\"Onaylama hatasÄ±:\", err);\n      alert(\"BaÄŸlantÄ± hatasÄ± oluÅŸtu.\");\n    }\n  };\n  return /*#__PURE__*/React.createElement(PanelTemplate, {\n    title: \"Orders\",\n    rightContent: /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 17\n      }\n    }, orders.length === 0 && /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 45\n      }\n    }, \"No pending orders.\"), orders.length > 0 && /*#__PURE__*/React.createElement(\"table\", {\n      border: \"1\",\n      style: {\n        width: \"100%\",\n        marginTop: \"20px\",\n        textAlign: \"center\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 37\n      }\n    }, \"Pending Order ID\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 37\n      }\n    }, \"Customer\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 37\n      }\n    }, \"Order Date\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 37\n      }\n    }, \"Total Amount\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 37\n      }\n    }, \"Action\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 29\n      }\n    }, orders.map(order => /*#__PURE__*/React.createElement(\"tr\", {\n      key: order.pending_order_id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 41\n      }\n    }, order.pending_order_id), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 41\n      }\n    }, order.customer_name), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 41\n      }\n    }, order.order_date), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 41\n      }\n    }, order.total_amount, \" \\u20BA\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: () => approveOrder(order.pending_order_id),\n      style: {\n        backgroundColor: \"#c50b0b\",\n        color: \"white\",\n        padding: \"8px 20px\",\n        borderRadius: \"8px\",\n        border: \"none\",\n        cursor: \"pointer\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 45\n      }\n    }, \"Onayla\"))))))),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }\n  });\n}\nexport default Orders;","map":{"version":3,"names":["React","useEffect","useState","PanelTemplate","Orders","orders","setOrders","fetch","then","res","json","data","success","approveOrder","pendingOrderId","storedInfo","localStorage","getItem","info","JSON","parse","approvedById","person_id","approvedByRole","role","window","location","pathname","includes","alert","concat","method","headers","body","stringify","approved_by_id","approved_by_role","prev","filter","o","pending_order_id","message","err","console","error","createElement","title","rightContent","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","length","border","style","width","marginTop","textAlign","map","order","key","customer_name","order_date","total_amount","onClick","backgroundColor","color","padding","borderRadius","cursor"],"sources":["/Users/merveerkan/Desktop/NurCollection/Frontend/src/pages/Orders.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport PanelTemplate from \"./PanelTemplate\";\n\nfunction Orders() {\n    const [orders, setOrders] = useState([]);\n\n    useEffect(() => {\n        fetch(\"http://localhost:5003/order/pending\")\n            .then(res => res.json())\n            .then(data => {\n                if (data.success) {\n                    setOrders(data.orders);\n                }\n            });\n    }, []);\n\n    const approveOrder = async (pendingOrderId) => {\n        // 1. ADIM: Bilgileri tek baÅŸÄ±na deÄŸil, \"info\" paketi iÃ§inden alÄ±yoruz\n        const storedInfo = localStorage.getItem(\"info\");\n        const info = storedInfo ? JSON.parse(storedInfo) : null;\n\n        // ðŸ”¥ KRÄ°TÄ°K DÃœZELTME: info paketinin iÃ§indeki person_id ve role alanlarÄ±nÄ± kullanÄ±yoruz\n        const approvedById = info?.person_id;\n        const approvedByRole = info?.role || (window.location.pathname.includes(\"manager\") ? \"manager\" : \"employee\");\n\n        if (!approvedById) {\n            alert(\"Onaylayan kiÅŸi (oturum bilgisi) bulunamadÄ±. LÃ¼tfen tekrar giriÅŸ yapÄ±n.\");\n            return;\n        }\n\n        try {\n            const res = await fetch(\n                `http://localhost:5003/order/approve/${pendingOrderId}`,\n                {\n                    method: \"POST\",\n                    headers: { \"Content-Type\": \"application/json\" },\n                    body: JSON.stringify({\n                        approved_by_id: approvedById,\n                        approved_by_role: approvedByRole\n                    })\n                }\n            );\n\n            const data = await res.json();\n\n            if (data.success) {\n                alert(\"SipariÅŸ baÅŸarÄ±yla onaylandÄ±\");\n                setOrders(prev =>\n                    prev.filter(o => o.pending_order_id !== pendingOrderId)\n                );\n            } else {\n                alert(data.message);\n            }\n        } catch (err) {\n            console.error(\"Onaylama hatasÄ±:\", err);\n            alert(\"BaÄŸlantÄ± hatasÄ± oluÅŸtu.\");\n        }\n    };\n\n    return (\n        <PanelTemplate\n            title=\"Orders\"\n            rightContent={\n                <div>\n                    {orders.length === 0 && <p>No pending orders.</p>}\n\n                    {orders.length > 0 && (\n                        <table\n                            border=\"1\"\n                            style={{\n                                width: \"100%\",\n                                marginTop: \"20px\",\n                                textAlign: \"center\"\n                            }}\n                        >\n                            <thead>\n                                <tr>\n                                    <th>Pending Order ID</th>\n                                    <th>Customer</th>\n                                    <th>Order Date</th>\n                                    <th>Total Amount</th>\n                                    <th>Action</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {orders.map(order => (\n                                    <tr key={order.pending_order_id}>\n                                        <td>{order.pending_order_id}</td>\n                                        <td>{order.customer_name}</td>\n                                        <td>{order.order_date}</td>\n                                        <td>{order.total_amount} â‚º</td>\n                                        <td>\n                                            <button\n                                                onClick={() =>\n                                                    approveOrder(order.pending_order_id)\n                                                }\n                                                style={{\n                                                    backgroundColor: \"#c50b0b\",\n                                                    color: \"white\",\n                                                    padding: \"8px 20px\",\n                                                    borderRadius: \"8px\",\n                                                    border: \"none\",\n                                                    cursor: \"pointer\"\n                                                }}\n                                            >\n                                                Onayla\n                                            </button>\n                                        </td>\n                                    </tr>\n                                ))}\n                            </tbody>\n                        </table>\n                    )}\n                </div>\n            }\n        />\n    );\n}\n\nexport default Orders;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}